---
title: "Components & Patterns"
description: "Core component APIs and UI patterns used across the Vector frontend."
---

<Note>
  For the full list of every component with usage locations, see [Component Inventory](/frontend/component-inventory).
  For per-page component trees, see [Page Component Trees](/frontend/page-trees).
</Note>

## Core components

### DataTable

`src/components/ui/data-table.tsx`

Generic data table built on TanStack React Table. Used directly for custom table layouts (InitiativesList, ProjectsList, SessionsList, InitiativeDetail) and as the base for `DecisionsTable` and `CommitmentsTable`.

| Prop | Type | Default | Description |
|---|---|---|---|
| `columns` | `ColumnDef<TData, TValue>[]` | required | Column definitions |
| `data` | `TData[]` | required | Row data |
| `onRowClick` | `(row: TData) => void` | — | Row click handler (adds `cursor-pointer`) |
| `columnVisibility` | `VisibilityState` | — | TanStack column visibility state |
| `grouping` | `GroupingState` | — | Column IDs to group by (enables grouped rows) |
| `renderGroupRow` | `(row, colSpan) => ReactNode` | — | Custom render for group header rows |
| `emptyMessage` | `string` | `"No results."` | Text shown when data is empty |
| `noDividers` | `boolean` | `false` | Remove row border-bottom dividers |
| `onReorder` | `(fromIndex, toIndex) => void` | — | Enable drag-and-drop reordering via @dnd-kit |
| `getRowId` | `(row: TData) => string` | — | Stable ID function for sortable rows |
| `showSelect` | `boolean` | `true` | Prepend row selection checkbox column |
| `showDragHandle` | `boolean` | `true` | Prepend drag handle column (only when `onReorder` is set) |
| `showHeader` | `boolean` | `true` | Show table header row |

**Features:**
- **Sorting** — click column headers to sort ascending/descending (arrow indicators)
- **Row selection** — checkbox column with select-all in header
- **Drag-and-drop** — when `onReorder` is provided, rows become draggable via `@dnd-kit/sortable`. Stable IDs (via `getRowId`) are required — array indices don't work because they don't change after reorder
- **Grouping** — when `grouping` is set, rows are grouped with collapsible group headers. `renderGroupRow` allows custom group row rendering (e.g. initiative name + project count in ProjectsList)
- **Column meta** — columns can set `meta.headerClassName` and `meta.cellClassName` for per-column styling

### DecisionsTable

`src/components/DecisionsTable.tsx`

Wraps `DataTable` for decision lists. Provides decision-specific columns with configurable visibility.

**Columns:** ref (e.g. DEC-1), statement (link or click handler), submitted (DateField with date + age), circle (CircleField pill), session (link badge), owner/sponsor (PersonField avatar), status (StatusField icon+text).

| Prop | Type | Default | Description |
|---|---|---|---|
| `decisions` | `Decision[]` | required | Decision data |
| `showCircle` | `boolean` | `true` | Show circle column |
| `showSession` | `boolean` | `false` | Show session link column |
| `showSubmitted` | `boolean` | `true` | Show submitted column (date + age via DateField) |
| `showOwner` | `boolean` | `true` | Show owner column |
| `noDividers` | `boolean` | — | Remove row dividers |
| `onReorder` | `(from, to) => void` | — | Enable drag-and-drop |
| `onDecisionClick` | `(decision) => void` | — | Click handler (replaces default Link navigation) |
| `showSelect` | `boolean` | — | Show row selection checkboxes |
| `showDragHandle` | `boolean` | — | Show drag handle |
| `showHeader` | `boolean` | — | Show table header |
| `combinedStatusOwner` | `boolean` | `false` | Merge StatusField + owner avatar into a single right-aligned column (hides individual status, owner, and submitted columns) |
| `personColumn` | `"owner"` / `"sponsor"` | `"owner"` | Which person to show in person column |

### CommitmentsTable

`src/components/CommitmentsTable.tsx`

Wraps `DataTable` for commitment lists. Same pattern as DecisionsTable.

**Columns:** ref (e.g. COM-1), outcome (link), decision ref, circle, owner (PersonField avatar), due date, status (StatusField icon+text).

| Prop | Type | Default | Description |
|---|---|---|---|
| `commitments` | `Commitment[]` | required | Commitment data |
| `showOwner` | `boolean` | `true` | Show owner column |
| `showCircle` | `boolean` | `true` | Show circle column |
| `showDecision` | `boolean` | `true` | Show decision column |
| `noDividers` | `boolean` | — | Remove row dividers |
| `showSelect` | `boolean` | — | Show row selection checkboxes |
| `showHeader` | `boolean` | — | Show table header |
| `combinedStatusOwner` | `boolean` | `false` | Merge decision ref label + owner avatar into a single right-aligned column (hides individual owner, status, due, and decision columns) |

### EntityIcon

`src/components/EntityIcon.tsx`

Centralized icon map for all domain entities. Maps each `EntityType` to its canonical Lucide icon. Every entity icon reference in the app goes through this component to ensure consistency. Size is controlled via `className`.

```tsx
<EntityIcon type="decision" className="h-3 w-3" />
```

### AppSidebar

`src/components/AppSidebar.tsx`

Navigation sidebar using shadcn `Sidebar*` primitives and Radix `Collapsible`. All entity icons use `EntityIcon`.

**Structure:**
- **Header** — workspace switcher dropdown (DropdownMenu). Shows active workspace name + ChevronsUpDown icon. Dropdown lists all workspaces the current user belongs to with a Check icon on the active one. Switching workspace navigates to `/` and persists the selection in localStorage.
- **Top links** — Inbox, My Items
- **Workspace** (collapsible, default open) — Initiatives, Projects, Circles
- **Your Circles** (collapsible, default open) — one collapsible per user circle (filtered by active workspace):
  - Sessions — with nested Previous / Upcoming shortcuts (link to last completed or next upcoming session)
  - Decisions
  - Commitments

Per-circle icons are resolved dynamically using the `icons` record from `lucide-react`, keyed by the circle's `icon` field returned from the API.

The first circle is expanded by default. Active route is highlighted via `location.pathname` matching. Session sub-items (Previous/Upcoming) highlight based on whether the currently viewed session is completed or not.

---

## Patterns

### Page header injection

Every page uses the `usePageHeader` hook to inject its header content into the App shell's sticky header area. The hook accepts a `PageHeaderConfig` object and passes it up via React Router's Outlet context. The App shell renders this content in a fixed position above the scroll area.

```tsx
usePageHeader({
  pageTitle: "Inbox",
  headerContent: (
    <PageHeader>
      <PageHeaderRow>
        <PageHeaderGroup>{/* left items */}</PageHeaderGroup>
        <PageHeaderGroup>{/* right items */}</PageHeaderGroup>
      </PageHeaderRow>
    </PageHeader>
  ),
}, dependencyKey)
```

The second argument is a dependency key string that triggers re-renders when relevant state changes (e.g. active tab, filter values).

### Header layout convention

Most pages follow a two-row header:

- **Row 1** — page title, tab switches (pill buttons), primary action button (e.g. "New Decision")
- **Row 2** — Filter popover (left), Display popover (right)

Tab switches are styled as small bordered pill buttons with active/inactive states. They are not a dedicated component — each page renders them inline with `cn()` conditional classes.

### Column visibility

Tables use TanStack's `columnVisibility` state to show/hide columns based on context. Wrapper components (DecisionsTable, CommitmentsTable) map boolean props like `showCircle`, `showSubmitted` to the visibility state object.

### Combined columns

On compact views (e.g. Session Detail), multiple columns are merged into a single right-aligned column using the `combinedStatusOwner` prop. For DecisionsTable this shows a status Badge + owner avatar. For CommitmentsTable this shows a decision ref label + owner avatar. When combined mode is active, the individual status, owner, due, and submitted columns are hidden.

### Detail page layout

Detail pages share a common structure with `max-w-[800px]` centered main content.

- **DecisionDetail** and **CommitmentDetail** — no sidebar. All properties are rendered inline via `PropertiesRow` in the main content area.
- **InitiativeDetail** and **ProjectDetail** — toggleable right sidebar (288px) via PanelRight icon button with CSS transition on width. Contains `SidebarSection` with `PropertiesRow` (stacked) inside.
- **SessionDetail** — no sidebar, but a 480px decision drawer that opens on decision row click.

DecisionDetail has no tabs — all content (description, discussion, summary, commitments, activity) renders on a single scrollable page. CommitmentDetail is also single-page (alert banner, outcome, properties, linked decision, activity).

### Inline editing

Two components handle inline editing:

- **TextField** — click-to-edit text field with full styling control via Tailwind utility props (`size`, `weight`, `color`, `leading`, `tracking`). Used for page titles (`as="h1"`, heading styles), descriptions, and summaries. Supports `multiline` for textarea mode. Renders static text that becomes an input on click — Enter/blur saves, Escape cancels. Supports `editable` prop (default `true`) — when `false`, click-to-edit is disabled.
- **PropertySelect** — click-to-open popover with options list. Used for health, target, owner. Each option can have an icon. Shows checkmark on selected value. (Status fields now use the dedicated `StatusField` component.)

### Inline editing persistence

All editable fields on detail pages persist changes to the backend via PATCH. The pattern is:

1. **Optimistic UI** — field `onChange`/`onSelect` updates local state (`overrides`/`personOverrides`) immediately for instant feedback
2. **Mutation call** — the same handler also calls the entity's `useUpdate*` mutation (e.g. `useUpdateDecision`) with a typed `*Patch` payload
3. **Error handling** — on failure, `toast.error("Failed to save")` is shown via Sonner (no success toast)

**Timing by field type:**
- **TextField** (titles, descriptions) — fires `onChange` on blur → immediate PATCH
- **StatusField, PersonField, DateField, CircleField** — fire on select → immediate PATCH
- **MarkdownEditor** (TipTap) — fires `onChange` on every keystroke → debounced PATCH via `useDebouncedSave` hook (800ms, flushes on unmount)

**FK writes:** The backend expects `*Id` fields for foreign key writes (e.g. `ownerId`, `sponsorId`, `circleId`) but returns nested objects on read. Each service file exports a `*Patch` type with the correct write-side field names.

**CommitmentDetail** respects the `editable` flag — mutations only fire when the commitment is accessed from a session with status "Open".

### Friendly dates

The `friendlyDate` helper (in SessionDetail) renders dates as "Today", "Tomorrow", "Yesterday", or "Mon DD" format for recent dates. Used in session breadcrumbs.

### Workspace context

`WorkspaceProvider` wraps the entire app and stores the active workspace slug. All API calls include the workspace slug in the URL path (`/api/v1/workspaces/{slug}/...`), so data is scoped at the API level.

```tsx
const { activeWorkspaceId, setActiveWorkspaceId, workspace, workspaces, basePath } = useWorkspace()
```

- **React Query hooks** include the workspace slug as part of the query key, so cache is workspace-scoped automatically.
- **PersonField** and **ProjectField** accept an optional `workspaceId` prop to scope their picker dropdowns to the active workspace's people/projects.

