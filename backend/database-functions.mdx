---
title: "Background Jobs & Commands"
description: "Django management commands, model validation, and planned automation."
---

Most of Vector's behavior is handled by DRF viewsets and serializers. The items below cover custom logic that runs outside normal request handling.

## Changelog as JSON

Activity history for decisions, commitments, and sessions is stored as a `JSONField` directly on each entity. Each entry in the array follows this structure:

```json
{
  "action": "status",
  "person": "Matt Welle",
  "date": "2026-02-10",
  "from": "Scheduled",
  "to": "Taken"
}
```

Common action types: `created`, `status`, `sponsor`, `owner`, `assigned`, `due`.

This approach was chosen over a separate `activity_events` table for simplicity — the changelog data is always read with its parent entity and doesn't need independent querying.

## CamelCase JSON transformation

The API uses `djangorestframework-camel-case` to automatically convert between Python's `snake_case` (backend) and JavaScript's `camelCase` (frontend). This is configured globally in `REST_FRAMEWORK` settings:

- **Renderers** — `CamelCaseJSONRenderer` transforms response keys to camelCase
- **Parsers** — `CamelCaseJSONParser` transforms request keys to snake_case

This means the frontend sends and receives camelCase JSON while the backend works entirely in snake_case.

## Management commands

### Seed data

The `seed` management command populates both workspaces (Mews and Terraverde) with development data:

```bash
cd backend
python manage.py seed
```

Creates:
- 2 workspaces, 15 users (password: `vector123`), workspace memberships
- 6 circles with memberships and chairs
- 9 initiatives, 18 projects
- 31 decisions, 37 commitments
- 18 sessions with linked decisions and commitments
- 27 updates (health reports for projects and initiatives)

Uses `get_or_create` throughout for idempotency — safe to run multiple times.

### Planned: Auto-roll commitments

A scheduled command that would run daily and roll commitments whose due date has passed. Not yet implemented.

### Planned: Notification dispatch

A management command (or Celery task, if needed) that sends notifications when specific events occur — e.g., a commitment is assigned, a decision is scheduled, or a session is closed. Not yet implemented.

## Migration strategy

All database changes are managed via Django migrations:

```bash
# Create a new migration after model changes
python manage.py makemigrations

# Apply migrations
python manage.py migrate

# Create a custom data migration
python manage.py makemigrations --empty app_name -n description
```

Migration files live in each app's `migrations/` directory and are version-controlled in Git. Railway runs `python manage.py migrate` automatically on deploy.
