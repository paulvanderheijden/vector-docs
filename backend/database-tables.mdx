---
title: "Database Tables"
description: "Django model definitions for Vector."
---

All tables are defined as Django models and managed via Django migrations. The schema below represents the Django model structure. Tables are prefixed with their app name (`authentication_` or `core_`).

## Naming conventions

- Table names: Django auto-generated from `{app}_{model}` (e.g., `core_decision`, `authentication_user`)
- Column names: `snake_case` (`sponsor_id`, `workspace_id`)
- Foreign keys: `{entity}_id` (`circle_id`, `initiative_id`)
- Primary keys: Auto-increment integers (Django default)
- Enums: `CharField` with `choices` constraint

## Auth tables

These tables are in the `authentication` app.

### authentication_user

The custom User model extends Django's `AbstractUser` with email-based login.

| Column | Type | Notes |
|---|---|---|
| `id` | integer | Primary key (auto) |
| `email` | email | Unique, login identifier |
| `password` | varchar | Hashed password |
| `first_name` | varchar(150) | From AbstractUser |
| `last_name` | varchar(150) | From AbstractUser |
| `job_title` | varchar(255) | Profile field, blank allowed |
| `avatar_url` | url(500) | Profile field, blank allowed |
| `last_active_workspace_id` | FK → Workspace | Nullable |
| `is_active` | boolean | Django built-in |
| `is_staff` | boolean | Django built-in |
| `is_superuser` | boolean | Django built-in |
| `date_joined` | datetime | Django built-in |

Computed properties (not stored):
- `name` — `"{first_name} {last_name}"` or email fallback
- `initials` — first letter of first + last name, or first letter of email

### authentication_workspace

| Column | Type | Notes |
|---|---|---|
| `id` | integer | Primary key (auto) |
| `name` | varchar(255) | |
| `slug` | slug | Unique |
| `created_at` | datetime | Auto-set on create |

### authentication_workspacemember

| Column | Type | Notes |
|---|---|---|
| `id` | integer | Primary key (auto) |
| `user_id` | FK → User | |
| `workspace_id` | FK → Workspace | |
| `role` | varchar(50) | `admin` or `member` |
| `is_active` | boolean | Default `true`. Set to `false` for soft-delete. |

**Unique constraint:** `(user, workspace)`

| Role | Description |
|---|---|
| `admin` | Can manage workspace settings, invite/remove people, create/edit circles |
| `member` | Can view and create entities within the workspace |

## Domain tables

All domain tables are in the `core` app. All inherit from `WorkspaceScopedModel`, which provides a `workspace` FK.

### core_circle

| Column | Type | Notes |
|---|---|---|
| `id` | integer | Primary key (auto) |
| `workspace_id` | FK → Workspace | |
| `name` | varchar(255) | |
| `slug` | slug(255) | |
| `cadence` | varchar(20) | `Weekly`, `Biweekly`, or `Manual` |
| `icon` | varchar(50) | Lucide icon name (e.g., `Users`) |
| `icon_bg` | varchar(100) | Tailwind classes for icon background |

**Unique constraint:** `(workspace, slug)`

| Cadence | Description |
|---|---|
| `Weekly` | Meets every week |
| `Biweekly` | Meets every two weeks |
| `Manual` | Sessions are created manually |

### core_circlemembership

| Column | Type | Notes |
|---|---|---|
| `id` | integer | Primary key (auto) |
| `circle_id` | FK → Circle | CASCADE |
| `user_id` | FK → User | CASCADE |
| `is_chair` | boolean | Default `false`. A circle can have one or more chairs. |

**Unique constraint:** `(circle, user)`

The `is_chair` flag replaces the old `Member`/`Organizer` role model. Circle chairs have session management capabilities (creating sessions, managing agendas, closing sessions).

### core_initiative

| Column | Type | Notes |
|---|---|---|
| `id` | integer | Primary key (auto) |
| `workspace_id` | FK → Workspace | |
| `title` | varchar(255) | |
| `slug` | slug(255) | |
| `summary` | text | Blank allowed |
| `description` | text | Blank allowed |
| `owner_id` | FK → User | Nullable, SET_NULL |
| `icon` | varchar(50) | Lucide icon name |
| `icon_color` | varchar(100) | Tailwind color class |
| `target` | varchar(100) | Target date/quarter (e.g., "Q2 2026") |
| `status` | varchar(20) | `planned`, `active`, or `completed` |

**Unique constraint:** `(workspace, slug)`

### core_project

| Column | Type | Notes |
|---|---|---|
| `id` | integer | Primary key (auto) |
| `workspace_id` | FK → Workspace | |
| `title` | varchar(255) | |
| `slug` | slug(255) | |
| `description` | text | Blank allowed |
| `initiative_id` | FK → Initiative | CASCADE |
| `owner_id` | FK → User | Nullable, SET_NULL |

**Unique constraint:** `(workspace, slug)`

### core_decision

| Column | Type | Notes |
|---|---|---|
| `id` | integer | Primary key (auto) |
| `workspace_id` | FK → Workspace | |
| `ref` | varchar(20) | Display reference (e.g., `D-1`) |
| `statement` | varchar(500) | The decision statement |
| `slug` | slug(255) | |
| `description` | text | Blank allowed |
| `discussion` | text | Blank allowed |
| `summary` | text | Blank allowed |
| `status` | varchar(20) | See status enum below |
| `rolled` | boolean | Default `false`. Set when session closes with decision unresolved. |
| `requested_date` | date | Nullable. Auto-set on Draft → Requested transition. |
| `circle_id` | FK → Circle | CASCADE |
| `requested_by_id` | FK → User | Nullable, SET_NULL |
| `sponsor_id` | FK → User | Nullable, SET_NULL |
| `owner_id` | FK → User | Nullable, SET_NULL |
| `revisit_of_id` | FK → self | Nullable, SET_NULL |
| `changelog` | JSON | Array of changelog entries |

**Unique constraint:** `(workspace, slug)`

**M2M:** `projects` via `core_decisionproject`

| Status | Description |
|---|---|
| `Draft` | Created but not ready for discussion |
| `Requested` | Formally submitted to a circle. Age counter starts. |
| `Scheduled` | On a session's agenda. A sponsor has been assigned. |
| `Taken` | The circle made the call. An owner has been assigned. |
| `Rolled` | Was on the agenda but not resolved. |
| `Superseded` | Replaced by a newer decision. |

### core_decisionproject

M2M through table linking decisions to projects.

| Column | Type | Notes |
|---|---|---|
| `id` | integer | Primary key (auto) |
| `decision_id` | FK → Decision | CASCADE |
| `project_id` | FK → Project | CASCADE |

**Unique constraint:** `(decision, project)`

### core_commitment

| Column | Type | Notes |
|---|---|---|
| `id` | integer | Primary key (auto) |
| `workspace_id` | FK → Workspace | |
| `ref` | varchar(20) | Display reference (e.g., `C-1`) |
| `outcome` | varchar(500) | The commitment outcome statement |
| `slug` | slug(255) | |
| `description` | text | Blank allowed |
| `status` | varchar(20) | `Active`, `Delivered`, or `Rolled` |
| `due` | varchar(100) | Due date/period as text (e.g., "Q1 2026") |
| `circle_id` | FK → Circle | CASCADE |
| `owner_id` | FK → User | Nullable, SET_NULL |
| `decision_id` | FK → Decision | Nullable, SET_NULL. Optional link to originating decision. |
| `project_id` | FK → Project | Nullable, SET_NULL. Optional link to a project. |
| `changelog` | JSON | Array of changelog entries |

**Unique constraint:** `(workspace, slug)`

### core_session

| Column | Type | Notes |
|---|---|---|
| `id` | integer | Primary key (auto) |
| `workspace_id` | FK → Workspace | |
| `number` | positive integer | Session number within a circle |
| `title` | varchar(255) | |
| `slug` | slug(255) | |
| `date` | date | |
| `status` | varchar(20) | `Open`, `Closed`, or `Cancelled` |
| `notes` | text | Blank allowed |
| `circle_id` | FK → Circle | CASCADE |
| `changelog` | JSON | Array of changelog entries |

**Unique constraint:** `(workspace, slug)`

**M2M:** `decisions` via `core_sessiondecision`, `commitments` via `core_sessioncommitment`

### core_sessiondecision

Through table linking sessions to decisions with ordering.

| Column | Type | Notes |
|---|---|---|
| `id` | integer | Primary key (auto) |
| `session_id` | FK → Session | CASCADE |
| `decision_id` | FK → Decision | CASCADE |
| `order` | positive integer | Display order, default `0` |

**Unique constraint:** `(session, decision)`
**Default ordering:** `order` ascending

### core_sessioncommitment

Through table linking sessions to commitments with ordering.

| Column | Type | Notes |
|---|---|---|
| `id` | integer | Primary key (auto) |
| `session_id` | FK → Session | CASCADE |
| `commitment_id` | FK → Commitment | CASCADE |
| `order` | positive integer | Display order, default `0` |

**Unique constraint:** `(session, commitment)`
**Default ordering:** `order` ascending

### core_update

Health updates for initiatives and projects.

| Column | Type | Notes |
|---|---|---|
| `id` | integer | Primary key (auto) |
| `workspace_id` | FK → Workspace | |
| `initiative_id` | FK → Initiative | Nullable, CASCADE |
| `project_id` | FK → Project | Nullable, CASCADE |
| `author_id` | FK → User | Nullable, SET_NULL |
| `date` | date | |
| `health` | varchar(20) | `on-track`, `at-risk`, or `off-track` |
| `content` | text | Markdown content |

**Default ordering:** `-date` (newest first)

Exactly one of `initiative_id` or `project_id` must be set per update.

| Health | Description |
|---|---|
| `on-track` | Progressing as expected, no blockers |
| `at-risk` | Potential delays or blockers that may cause problems |
| `off-track` | Behind schedule or significant issues needing intervention |

## Design decisions

### Person = User

There is no separate `Person` table. The Django `User` model stores both authentication credentials and profile data (`first_name`, `last_name`, `job_title`, `avatar_url`). The `name` and `initials` properties are computed at the model level.

### Changelog as JSONField

Activity history for decisions, commitments, and sessions is stored as a JSON array directly on each entity rather than in a separate `activity_events` table. This keeps queries simple and matches the frontend's data structure.

### Auto-increment IDs

All tables use Django's default auto-increment integer primary keys. UUIDs were considered but are not needed for this application.

### Soft deletes

Workspace members are soft-deleted by setting `is_active = false`. All foreign keys to User use `SET_NULL` so historical references (requestor, sponsor, owner on past decisions) remain intact.
